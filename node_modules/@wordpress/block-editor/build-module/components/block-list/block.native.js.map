{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/block.native.js"],"names":["View","Text","TouchableWithoutFeedback","Dimensions","Component","createRef","GlobalStylesContext","getMergedGlobalStyles","alignmentHelpers","withDispatch","withSelect","compose","withPreferredColorScheme","getBlockType","__experimentalGetAccessibleBlockLabel","getAccessibleBlockLabel","__experimentalUseEditorFeature","useEditorFeature","styles","BlockEdit","BlockInvalidWarning","BlockMobileToolbar","BlockForType","attributes","clientId","contentStyle","getBlockWidth","insertBlocksAfter","isSelected","mergeBlocks","name","onBlockFocus","onCaretVerticalPositionChange","onChange","onDeleteBlock","onReplace","parentWidth","wrapperProps","defaultColors","globalStyle","mergedStyle","style","BlockListBlock","arguments","bind","onFocus","state","blockWidth","anchorNodeRef","props","firstToSelectId","onSelect","blocks","onInsertBlocks","order","nativeEvent","layout","layoutWidth","Math","floor","width","setState","blockTitle","blockType","icon","isValid","title","isDimmed","isTouchable","isStackedHorizontally","isParentSelected","getStylesFromColorScheme","marginVertical","marginHorizontal","isInnerBlockSelected","align","accessibilityLabel","isFullWidth","isWider","isContainerRelated","accessible","screenWidth","get","isScreenWidthEqual","isScreenWidthWider","isFullWidthToolbar","flex","dimmed","solidBorder","borderFullWidth","containerBorderFullWidth","solidBorderColor","solidBorderColorDark","dashedBorder","dashedBorderColor","dashedBorderColorDark","getBlockForType","neutralToolbar","containerToolbar","current","wrapperPropsCache","WeakMap","emptyObj","getWrapperProps","value","getWrapperPropsFunction","cachedValue","set","select","rootClientId","getBlockIndex","isBlockSelected","__unstableGetBlockWithoutInnerBlocks","getSelectedBlockClientId","getLowestCommonAncestorWithSelectedBlock","getBlockParents","hasSelectedInnerBlock","block","parents","parentId","selectedBlockClientId","commonAncestor","commonAncestorIndex","indexOf","length","selectedParents","isDescendantOfParentSelected","includes","getEditWrapperProps","dispatch","ownProps","insertBlocks","replaceBlocks","selectBlock","updateBlockAttributes","forward","getPreviousBlockClientId","getNextBlockClientId","nextBlockClientId","previousBlockClientId","index","initialPosition","indexToSelect"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { View, Text, TouchableWithoutFeedback, Dimensions } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Component, createRef } from '@wordpress/element';\nimport {\n\tGlobalStylesContext,\n\tgetMergedGlobalStyles,\n\talignmentHelpers,\n} from '@wordpress/components';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport {\n\tgetBlockType,\n\t__experimentalGetAccessibleBlockLabel as getAccessibleBlockLabel,\n} from '@wordpress/blocks';\nimport { __experimentalUseEditorFeature as useEditorFeature } from '@wordpress/block-editor';\n\n/**\n * Internal dependencies\n */\nimport styles from './block.scss';\nimport BlockEdit from '../block-edit';\nimport BlockInvalidWarning from './block-invalid-warning';\nimport BlockMobileToolbar from '../block-mobile-toolbar';\n\nfunction BlockForType( {\n\tattributes,\n\tclientId,\n\tcontentStyle,\n\tgetBlockWidth,\n\tinsertBlocksAfter,\n\tisSelected,\n\tmergeBlocks,\n\tname,\n\tonBlockFocus,\n\tonCaretVerticalPositionChange,\n\tonChange,\n\tonDeleteBlock,\n\tonReplace,\n\tparentWidth,\n\twrapperProps,\n} ) {\n\tconst defaultColors = useEditorFeature( 'color.palette' ) || [];\n\n\treturn (\n\t\t<GlobalStylesContext.Consumer>\n\t\t\t{ ( globalStyle ) => {\n\t\t\t\tconst mergedStyle = getMergedGlobalStyles(\n\t\t\t\t\tglobalStyle,\n\t\t\t\t\twrapperProps.style,\n\t\t\t\t\tattributes,\n\t\t\t\t\tdefaultColors\n\t\t\t\t);\n\n\t\t\t\treturn (\n\t\t\t\t\t<GlobalStylesContext.Provider value={ mergedStyle }>\n\t\t\t\t\t\t<BlockEdit\n\t\t\t\t\t\t\tname={ name }\n\t\t\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\t\t\tsetAttributes={ onChange }\n\t\t\t\t\t\t\tonFocus={ onBlockFocus }\n\t\t\t\t\t\t\tonReplace={ onReplace }\n\t\t\t\t\t\t\tinsertBlocksAfter={ insertBlocksAfter }\n\t\t\t\t\t\t\tmergeBlocks={ mergeBlocks }\n\t\t\t\t\t\t\tonCaretVerticalPositionChange={\n\t\t\t\t\t\t\t\tonCaretVerticalPositionChange\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Block level styles\n\t\t\t\t\t\t\twrapperProps={ wrapperProps }\n\t\t\t\t\t\t\t// inherited styles merged with block level styles\n\t\t\t\t\t\t\tmergedStyle={ mergedStyle }\n\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\tparentWidth={ parentWidth }\n\t\t\t\t\t\t\tcontentStyle={ contentStyle }\n\t\t\t\t\t\t\tonDeleteBlock={ onDeleteBlock }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<View onLayout={ getBlockWidth } />\n\t\t\t\t\t</GlobalStylesContext.Provider>\n\t\t\t\t);\n\t\t\t} }\n\t\t</GlobalStylesContext.Consumer>\n\t);\n}\n\nclass BlockListBlock extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.insertBlocksAfter = this.insertBlocksAfter.bind( this );\n\t\tthis.onFocus = this.onFocus.bind( this );\n\t\tthis.getBlockWidth = this.getBlockWidth.bind( this );\n\n\t\tthis.state = {\n\t\t\tblockWidth: 0,\n\t\t};\n\n\t\tthis.anchorNodeRef = createRef();\n\t}\n\n\tonFocus() {\n\t\tconst { firstToSelectId, isSelected, onSelect } = this.props;\n\t\tif ( ! isSelected ) {\n\t\t\tonSelect( firstToSelectId );\n\t\t}\n\t}\n\n\tinsertBlocksAfter( blocks ) {\n\t\tthis.props.onInsertBlocks( blocks, this.props.order + 1 );\n\n\t\tif ( blocks[ 0 ] ) {\n\t\t\t// focus on the first block inserted\n\t\t\tthis.props.onSelect( blocks[ 0 ].clientId );\n\t\t}\n\t}\n\n\tgetBlockWidth( { nativeEvent } ) {\n\t\tconst { layout } = nativeEvent;\n\t\tconst { blockWidth } = this.state;\n\t\tconst layoutWidth = Math.floor( layout.width );\n\n\t\tif ( blockWidth !== layoutWidth ) {\n\t\t\tthis.setState( { blockWidth: layoutWidth } );\n\t\t}\n\t}\n\n\tgetBlockForType() {\n\t\treturn (\n\t\t\t<BlockForType\n\t\t\t\t{ ...this.props }\n\t\t\t\tonBlockFocus={ this.onFocus }\n\t\t\t\tinsertBlocksAfter={ this.insertBlocksAfter }\n\t\t\t\tgetBlockWidth={ this.getBlockWidth }\n\t\t\t/>\n\t\t);\n\t}\n\n\trenderBlockTitle() {\n\t\treturn (\n\t\t\t<View style={ styles.blockTitle }>\n\t\t\t\t<Text>BlockType: { this.props.name }</Text>\n\t\t\t</View>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tattributes,\n\t\t\tblockType,\n\t\t\tclientId,\n\t\t\ticon,\n\t\t\tisSelected,\n\t\t\tisValid,\n\t\t\torder,\n\t\t\ttitle,\n\t\t\tisDimmed,\n\t\t\tisTouchable,\n\t\t\tonDeleteBlock,\n\t\t\tisStackedHorizontally,\n\t\t\tisParentSelected,\n\t\t\tgetStylesFromColorScheme,\n\t\t\tmarginVertical,\n\t\t\tmarginHorizontal,\n\t\t\tisInnerBlockSelected,\n\t\t\tname,\n\t\t} = this.props;\n\n\t\tif ( ! attributes || ! blockType ) {\n\t\t\treturn null;\n\t\t}\n\t\tconst { blockWidth } = this.state;\n\t\tconst { align } = attributes;\n\t\tconst accessibilityLabel = getAccessibleBlockLabel(\n\t\t\tblockType,\n\t\t\tattributes,\n\t\t\torder + 1\n\t\t);\n\t\tconst { isFullWidth, isWider, isContainerRelated } = alignmentHelpers;\n\t\tconst accessible = ! ( isSelected || isInnerBlockSelected );\n\t\tconst screenWidth = Math.floor( Dimensions.get( 'window' ).width );\n\t\tconst isScreenWidthEqual = blockWidth === screenWidth;\n\t\tconst isScreenWidthWider = blockWidth < screenWidth;\n\t\tconst isFullWidthToolbar = isFullWidth( align ) || isScreenWidthEqual;\n\n\t\treturn (\n\t\t\t<TouchableWithoutFeedback\n\t\t\t\tonPress={ this.onFocus }\n\t\t\t\taccessible={ accessible }\n\t\t\t\taccessibilityRole={ 'button' }\n\t\t\t>\n\t\t\t\t<View\n\t\t\t\t\tstyle={ { flex: 1 } }\n\t\t\t\t\taccessibilityLabel={ accessibilityLabel }\n\t\t\t\t>\n\t\t\t\t\t<View\n\t\t\t\t\t\tpointerEvents={ isTouchable ? 'auto' : 'box-only' }\n\t\t\t\t\t\taccessibilityLabel={ accessibilityLabel }\n\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\t{ marginVertical, marginHorizontal, flex: 1 },\n\t\t\t\t\t\t\tisDimmed && styles.dimmed,\n\t\t\t\t\t\t] }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ isSelected && (\n\t\t\t\t\t\t\t<View\n\t\t\t\t\t\t\t\tpointerEvents=\"box-none\"\n\t\t\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\t\t\tstyles.solidBorder,\n\t\t\t\t\t\t\t\t\tisFullWidth( align ) &&\n\t\t\t\t\t\t\t\t\t\tisScreenWidthWider &&\n\t\t\t\t\t\t\t\t\t\tstyles.borderFullWidth,\n\t\t\t\t\t\t\t\t\tisFullWidth( align ) &&\n\t\t\t\t\t\t\t\t\t\tisContainerRelated( name ) &&\n\t\t\t\t\t\t\t\t\t\tisScreenWidthWider &&\n\t\t\t\t\t\t\t\t\t\tstyles.containerBorderFullWidth,\n\t\t\t\t\t\t\t\t\tgetStylesFromColorScheme(\n\t\t\t\t\t\t\t\t\t\tstyles.solidBorderColor,\n\t\t\t\t\t\t\t\t\t\tstyles.solidBorderColorDark\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ isParentSelected && (\n\t\t\t\t\t\t\t<View\n\t\t\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\t\t\tstyles.dashedBorder,\n\t\t\t\t\t\t\t\t\tgetStylesFromColorScheme(\n\t\t\t\t\t\t\t\t\t\tstyles.dashedBorderColor,\n\t\t\t\t\t\t\t\t\t\tstyles.dashedBorderColorDark\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ isValid ? (\n\t\t\t\t\t\t\tthis.getBlockForType()\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<BlockInvalidWarning\n\t\t\t\t\t\t\t\tblockTitle={ title }\n\t\t\t\t\t\t\t\ticon={ icon }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<View\n\t\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\t\tstyles.neutralToolbar,\n\t\t\t\t\t\t\t\t! isFullWidthToolbar &&\n\t\t\t\t\t\t\t\t\tisContainerRelated( name ) &&\n\t\t\t\t\t\t\t\t\tisWider( screenWidth, 'mobile' ) &&\n\t\t\t\t\t\t\t\t\tstyles.containerToolbar,\n\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\tref={ this.anchorNodeRef }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ isSelected && (\n\t\t\t\t\t\t\t\t<BlockMobileToolbar\n\t\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\t\tonDelete={ onDeleteBlock }\n\t\t\t\t\t\t\t\t\tisStackedHorizontally={\n\t\t\t\t\t\t\t\t\t\tisStackedHorizontally\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tblockWidth={ blockWidth }\n\t\t\t\t\t\t\t\t\tanchorNodeRef={ this.anchorNodeRef.current }\n\t\t\t\t\t\t\t\t\tisFullWidth={ isFullWidthToolbar }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</View>\n\t\t\t\t</View>\n\t\t\t</TouchableWithoutFeedback>\n\t\t);\n\t}\n}\n\n// Helper function to memoize the wrapperProps since getEditWrapperProps always returns a new reference\nconst wrapperPropsCache = new WeakMap();\nconst emptyObj = {};\nfunction getWrapperProps( value, getWrapperPropsFunction ) {\n\tif ( ! getWrapperPropsFunction ) {\n\t\treturn emptyObj;\n\t}\n\tconst cachedValue = wrapperPropsCache.get( value );\n\tif ( ! cachedValue ) {\n\t\tconst wrapperProps = getWrapperPropsFunction( value );\n\t\twrapperPropsCache.set( value, wrapperProps );\n\t\treturn wrapperProps;\n\t}\n\treturn cachedValue;\n}\n\nexport default compose( [\n\twithSelect( ( select, { clientId, rootClientId } ) => {\n\t\tconst {\n\t\t\tgetBlockIndex,\n\t\t\tisBlockSelected,\n\t\t\t__unstableGetBlockWithoutInnerBlocks,\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetLowestCommonAncestorWithSelectedBlock,\n\t\t\tgetBlockParents,\n\t\t\thasSelectedInnerBlock,\n\t\t} = select( 'core/block-editor' );\n\n\t\tconst order = getBlockIndex( clientId, rootClientId );\n\t\tconst isSelected = isBlockSelected( clientId );\n\t\tconst isInnerBlockSelected = hasSelectedInnerBlock( clientId );\n\t\tconst block = __unstableGetBlockWithoutInnerBlocks( clientId );\n\t\tconst { name, attributes, isValid } = block || {};\n\n\t\tconst blockType = getBlockType( name || 'core/missing' );\n\t\tconst title = blockType.title;\n\t\tconst icon = blockType.icon;\n\n\t\tconst parents = getBlockParents( clientId, true );\n\t\tconst parentId = parents[ 0 ] || '';\n\n\t\tconst selectedBlockClientId = getSelectedBlockClientId();\n\n\t\tconst commonAncestor = getLowestCommonAncestorWithSelectedBlock(\n\t\t\tclientId\n\t\t);\n\t\tconst commonAncestorIndex = parents.indexOf( commonAncestor ) - 1;\n\t\tconst firstToSelectId = commonAncestor\n\t\t\t? parents[ commonAncestorIndex ]\n\t\t\t: parents[ parents.length - 1 ];\n\n\t\tconst isParentSelected =\n\t\t\t// set false as a default value to prevent re-render when it's changed from null to false\n\t\t\t( selectedBlockClientId || false ) &&\n\t\t\tselectedBlockClientId === parentId;\n\n\t\tconst selectedParents = selectedBlockClientId\n\t\t\t? getBlockParents( selectedBlockClientId )\n\t\t\t: [];\n\t\tconst isDescendantOfParentSelected = selectedParents.includes(\n\t\t\tparentId\n\t\t);\n\t\tconst isTouchable =\n\t\t\tisSelected ||\n\t\t\tisDescendantOfParentSelected ||\n\t\t\tisParentSelected ||\n\t\t\tparentId === '';\n\t\treturn {\n\t\t\ticon,\n\t\t\tname: name || 'core/missing',\n\t\t\torder,\n\t\t\ttitle,\n\t\t\tattributes,\n\t\t\tblockType,\n\t\t\tisSelected,\n\t\t\tisInnerBlockSelected,\n\t\t\tisValid,\n\t\t\tisParentSelected,\n\t\t\tfirstToSelectId,\n\t\t\tisTouchable,\n\t\t\twrapperProps: getWrapperProps(\n\t\t\t\tattributes,\n\t\t\t\tblockType.getEditWrapperProps\n\t\t\t),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, ownProps, { select } ) => {\n\t\tconst {\n\t\t\tinsertBlocks,\n\t\t\tmergeBlocks,\n\t\t\treplaceBlocks,\n\t\t\tselectBlock,\n\t\t\tupdateBlockAttributes,\n\t\t} = dispatch( 'core/block-editor' );\n\n\t\treturn {\n\t\t\tmergeBlocks( forward ) {\n\t\t\t\tconst { clientId } = ownProps;\n\t\t\t\tconst {\n\t\t\t\t\tgetPreviousBlockClientId,\n\t\t\t\t\tgetNextBlockClientId,\n\t\t\t\t} = select( 'core/block-editor' );\n\n\t\t\t\tif ( forward ) {\n\t\t\t\t\tconst nextBlockClientId = getNextBlockClientId( clientId );\n\t\t\t\t\tif ( nextBlockClientId ) {\n\t\t\t\t\t\tmergeBlocks( clientId, nextBlockClientId );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst previousBlockClientId = getPreviousBlockClientId(\n\t\t\t\t\t\tclientId\n\t\t\t\t\t);\n\t\t\t\t\tif ( previousBlockClientId ) {\n\t\t\t\t\t\tmergeBlocks( previousBlockClientId, clientId );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tonInsertBlocks( blocks, index ) {\n\t\t\t\tinsertBlocks( blocks, index, ownProps.rootClientId );\n\t\t\t},\n\t\t\tonSelect( clientId = ownProps.clientId, initialPosition ) {\n\t\t\t\tselectBlock( clientId, initialPosition );\n\t\t\t},\n\t\t\tonChange: ( attributes ) => {\n\t\t\t\tupdateBlockAttributes( ownProps.clientId, attributes );\n\t\t\t},\n\t\t\tonReplace( blocks, indexToSelect ) {\n\t\t\t\treplaceBlocks( [ ownProps.clientId ], blocks, indexToSelect );\n\t\t\t},\n\t\t};\n\t} ),\n\twithPreferredColorScheme,\n] )( BlockListBlock );\n"]}