{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/insertion-point.js"],"names":["classnames","last","useSelect","useState","useRef","useEffect","useCallback","Popover","placeCaretAtVerticalEdge","Inserter","getClosestTabbable","getBlockDOMNode","InsertionPointInserter","clientId","setIsInserterForced","containerRef","ref","isInserterHidden","select","getMultiSelectedBlockClientIds","getSelectedBlockClientId","hasMultiSelection","getSettings","hasReducedUI","multiSelectedBlockClientIds","selectedBlockClientId","includes","focusClosestTabbable","event","clientX","clientY","target","current","ownerDocument","targetRect","getBoundingClientRect","isReverse","top","height","blockNode","container","closest","rect","window","DOMRect","InsertionPointPopover","rootClientId","isInserterShown","isInserterForced","showInsertionPoint","element","getBlockOrder","targetClientId","position","className","width","offsetWidth","InsertionPoint","setIsInserterShown","inserterClientId","setInserterClientId","_isMultiSelecting","isMultiSelecting","isBlockInsertionPointVisible","getBlockInsertionPoint","insertionPoint","order","isInserterVisible","selectedClientId","index","selectedRootClientId","onMouseMove","classList","contains","offset","Array","from","children","find","blockEl","offsetTop","id","firstElementChild","slice","length","elementRect","right","left","enableMouseMove","addEventListener","removeEventListener","isVisible"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { last } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useSelect } from '@wordpress/data';\nimport { useState, useRef, useEffect, useCallback } from '@wordpress/element';\nimport { Popover } from '@wordpress/components';\nimport { placeCaretAtVerticalEdge } from '@wordpress/dom';\n\n/**\n * Internal dependencies\n */\nimport Inserter from '../inserter';\nimport { getClosestTabbable } from '../writing-flow';\nimport { getBlockDOMNode } from '../../utils/dom';\n\nfunction InsertionPointInserter( {\n\tclientId,\n\tsetIsInserterForced,\n\tcontainerRef,\n} ) {\n\tconst ref = useRef();\n\t// Hide the inserter above the selected block and during multi-selection.\n\tconst isInserterHidden = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetMultiSelectedBlockClientIds,\n\t\t\t\tgetSelectedBlockClientId,\n\t\t\t\thasMultiSelection,\n\t\t\t\tgetSettings,\n\t\t\t} = select( 'core/block-editor' );\n\t\t\tconst { hasReducedUI } = getSettings();\n\t\t\tif ( hasReducedUI ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tconst multiSelectedBlockClientIds = getMultiSelectedBlockClientIds();\n\t\t\tconst selectedBlockClientId = getSelectedBlockClientId();\n\t\t\treturn hasMultiSelection()\n\t\t\t\t? multiSelectedBlockClientIds.includes( clientId )\n\t\t\t\t: clientId === selectedBlockClientId;\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tfunction focusClosestTabbable( event ) {\n\t\tconst { clientX, clientY, target } = event;\n\n\t\t// Only handle click on the wrapper specifically, and not an event\n\t\t// bubbled from the inserter itself.\n\t\tif ( target !== ref.current ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { ownerDocument } = containerRef.current;\n\t\tconst targetRect = target.getBoundingClientRect();\n\t\tconst isReverse = clientY < targetRect.top + targetRect.height / 2;\n\t\tconst blockNode = getBlockDOMNode( clientId, ownerDocument );\n\t\tconst container = isReverse ? containerRef.current : blockNode;\n\t\tconst closest =\n\t\t\tgetClosestTabbable( blockNode, true, container ) || blockNode;\n\t\tconst rect = new window.DOMRect( clientX, clientY, 0, 16 );\n\n\t\tplaceCaretAtVerticalEdge( closest, isReverse, rect, false );\n\t}\n\n\treturn (\n\t\t/* eslint-disable-next-line jsx-a11y/no-static-element-interactions, jsx-a11y/click-events-have-key-events */\n\t\t<div\n\t\t\tref={ ref }\n\t\t\tonFocus={ () => setIsInserterForced( true ) }\n\t\t\tonBlur={ () => setIsInserterForced( false ) }\n\t\t\tonClick={ focusClosestTabbable }\n\t\t\t// While ideally it would be enough to capture the\n\t\t\t// bubbling focus event from the Inserter, due to the\n\t\t\t// characteristics of click focusing of `button`s in\n\t\t\t// Firefox and Safari, it is not reliable.\n\t\t\t//\n\t\t\t// See: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#Clicking_and_focus\n\t\t\ttabIndex={ -1 }\n\t\t\tclassName={ classnames(\n\t\t\t\t'block-editor-block-list__insertion-point-inserter',\n\t\t\t\t{\n\t\t\t\t\t'is-inserter-hidden': isInserterHidden,\n\t\t\t\t}\n\t\t\t) }\n\t\t>\n\t\t\t<Inserter\n\t\t\t\tposition=\"bottom center\"\n\t\t\t\tclientId={ clientId }\n\t\t\t\t__experimentalIsQuick\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nfunction InsertionPointPopover( {\n\tclientId,\n\trootClientId,\n\tisInserterShown,\n\tisInserterForced,\n\tsetIsInserterForced,\n\tcontainerRef,\n\tshowInsertionPoint,\n} ) {\n\tconst element = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockOrder } = select( 'core/block-editor' );\n\t\t\tconst { ownerDocument } = containerRef.current;\n\t\t\tconst targetClientId =\n\t\t\t\tclientId || last( getBlockOrder( rootClientId ) );\n\n\t\t\treturn getBlockDOMNode( targetClientId, ownerDocument );\n\t\t},\n\t\t[ clientId, rootClientId ]\n\t);\n\n\tconst position = clientId ? 'top' : 'bottom';\n\tconst className = classnames( 'block-editor-block-list__insertion-point', {\n\t\t'is-insert-after': ! clientId,\n\t} );\n\n\treturn (\n\t\t<Popover\n\t\t\tnoArrow\n\t\t\tanimate={ false }\n\t\t\tanchorRef={ element }\n\t\t\tposition={ `${ position } right left` }\n\t\t\tfocusOnMount={ false }\n\t\t\tclassName=\"block-editor-block-list__insertion-point-popover\"\n\t\t\t__unstableSlotName=\"block-toolbar\"\n\t\t\t__unstableForcePosition={ true }\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={ className }\n\t\t\t\tstyle={ { width: element?.offsetWidth } }\n\t\t\t>\n\t\t\t\t{ ( showInsertionPoint ||\n\t\t\t\t\tisInserterShown ||\n\t\t\t\t\tisInserterForced ) && (\n\t\t\t\t\t<div className=\"block-editor-block-list__insertion-point-indicator\" />\n\t\t\t\t) }\n\t\t\t\t{ ( isInserterShown || isInserterForced ) && (\n\t\t\t\t\t<InsertionPointInserter\n\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\tsetIsInserterForced={ setIsInserterForced }\n\t\t\t\t\t\tcontainerRef={ containerRef }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t</Popover>\n\t);\n}\n\nexport default function InsertionPoint( ref ) {\n\tconst [ isInserterShown, setIsInserterShown ] = useState( false );\n\tconst [ isInserterForced, setIsInserterForced ] = useState( false );\n\tconst [ inserterClientId, setInserterClientId ] = useState( null );\n\tconst {\n\t\tisMultiSelecting,\n\t\tisInserterVisible,\n\t\tselectedClientId,\n\t\tselectedRootClientId,\n\t} = useSelect( ( select ) => {\n\t\tconst {\n\t\t\tisMultiSelecting: _isMultiSelecting,\n\t\t\tisBlockInsertionPointVisible,\n\t\t\tgetBlockInsertionPoint,\n\t\t\tgetBlockOrder,\n\t\t} = select( 'core/block-editor' );\n\n\t\tconst insertionPoint = getBlockInsertionPoint();\n\t\tconst order = getBlockOrder( insertionPoint.rootClientId );\n\n\t\treturn {\n\t\t\tisMultiSelecting: _isMultiSelecting(),\n\t\t\tisInserterVisible: isBlockInsertionPointVisible(),\n\t\t\tselectedClientId: order[ insertionPoint.index ],\n\t\t\tselectedRootClientId: insertionPoint.rootClientId,\n\t\t};\n\t}, [] );\n\n\tconst onMouseMove = useCallback(\n\t\t( event ) => {\n\t\t\tif (\n\t\t\t\t! event.target.classList.contains(\n\t\t\t\t\t'block-editor-block-list__layout'\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tif ( isInserterShown ) {\n\t\t\t\t\tsetIsInserterShown( false );\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst rect = event.target.getBoundingClientRect();\n\t\t\tconst offset = event.clientY - rect.top;\n\t\t\tlet element = Array.from( event.target.children ).find(\n\t\t\t\t( blockEl ) => {\n\t\t\t\t\treturn blockEl.offsetTop > offset;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif ( ! element ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// The block may be in an alignment wrapper, so check the first direct\n\t\t\t// child if the element has no ID.\n\t\t\tif ( ! element.id ) {\n\t\t\t\telement = element.firstElementChild;\n\n\t\t\t\tif ( ! element ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst clientId = element.id.slice( 'block-'.length );\n\n\t\t\tif ( ! clientId ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst elementRect = element.getBoundingClientRect();\n\n\t\t\tif (\n\t\t\t\tevent.clientX > elementRect.right ||\n\t\t\t\tevent.clientX < elementRect.left\n\t\t\t) {\n\t\t\t\tif ( isInserterShown ) {\n\t\t\t\t\tsetIsInserterShown( false );\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetIsInserterShown( true );\n\t\t\tsetInserterClientId( clientId );\n\t\t},\n\t\t[ isInserterShown, setIsInserterShown, setInserterClientId ]\n\t);\n\n\tconst enableMouseMove = ! isInserterForced && ! isMultiSelecting;\n\n\tuseEffect( () => {\n\t\tif ( ! enableMouseMove ) {\n\t\t\treturn;\n\t\t}\n\n\t\tref.current.addEventListener( 'mousemove', onMouseMove );\n\n\t\treturn () => {\n\t\t\tref.current.removeEventListener( 'mousemove', onMouseMove );\n\t\t};\n\t}, [ enableMouseMove, onMouseMove ] );\n\n\tconst isVisible = isInserterShown || isInserterForced || isInserterVisible;\n\n\treturn (\n\t\t! isMultiSelecting &&\n\t\tisVisible && (\n\t\t\t<InsertionPointPopover\n\t\t\t\tclientId={\n\t\t\t\t\tisInserterVisible ? selectedClientId : inserterClientId\n\t\t\t\t}\n\t\t\t\trootClientId={ selectedRootClientId }\n\t\t\t\tisInserterShown={ isInserterShown }\n\t\t\t\tisInserterForced={ isInserterForced }\n\t\t\t\tsetIsInserterForced={ setIsInserterForced }\n\t\t\t\tcontainerRef={ ref }\n\t\t\t\tshowInsertionPoint={ isInserterVisible }\n\t\t\t/>\n\t\t)\n\t);\n}\n"]}