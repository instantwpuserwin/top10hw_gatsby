{"version":3,"sources":["@wordpress/components/src/tooltip/index.js"],"names":["includes","Children","cloneElement","concatChildren","useEffect","useState","Popover","Shortcut","useDebounce","TOOLTIP_DELAY","emitToChild","children","eventName","event","count","child","only","props","Tooltip","position","text","shortcut","isMouseDown","setIsMouseDown","isOver","setIsOver","delayedSetIsOver","createMouseDown","document","addEventListener","cancelIsMouseDown","createMouseUp","removeEventListener","createMouseEvent","type","createToggleIsOver","isDelayed","currentTarget","disabled","cancel","_isOver","clearOnUnmount","process","env","NODE_ENV","console","error","onMouseEnter","onMouseLeave","onClick","onFocus","onBlur","onMouseDown"],"mappings":";;;AAAA;AACA;AACA;AACA,SAASA,QAAT,QAAyB,QAAzB;AAEA;AACA;AACA;;AACA,SACCC,QADD,EAECC,YAFD,EAGCC,cAHD,EAICC,SAJD,EAKCC,QALD,QAMO,oBANP;AAQA;AACA;AACA;;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,OAAOC,QAAP,MAAqB,aAArB;AACA,SAASC,WAAT,QAA4B,oBAA5B;AAEA;AACA;AACA;AACA;AACA;;AACA,OAAO,IAAMC,aAAa,GAAG,GAAtB;;AAEP,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAAEC,QAAF,EAAYC,SAAZ,EAAuBC,KAAvB,EAAkC;AACrD,MAAKZ,QAAQ,CAACa,KAAT,CAAgBH,QAAhB,MAA+B,CAApC,EAAwC;AACvC;AACA;;AAED,MAAMI,KAAK,GAAGd,QAAQ,CAACe,IAAT,CAAeL,QAAf,CAAd;;AACA,MAAK,OAAOI,KAAK,CAACE,KAAN,CAAaL,SAAb,CAAP,KAAoC,UAAzC,EAAsD;AACrDG,IAAAA,KAAK,CAACE,KAAN,CAAaL,SAAb,EAA0BC,KAA1B;AACA;AACD,CATD;;AAWA,SAASK,OAAT,OAA2D;AAAA,MAAvCP,QAAuC,QAAvCA,QAAuC;AAAA,MAA7BQ,QAA6B,QAA7BA,QAA6B;AAAA,MAAnBC,IAAmB,QAAnBA,IAAmB;AAAA,MAAbC,QAAa,QAAbA,QAAa;;AAC1D;AACD;AACA;AACA;AACA;AACA;AAN2D,kBAOlBhB,QAAQ,CAAE,KAAF,CAPU;AAAA;AAAA,MAOlDiB,WAPkD;AAAA,MAOrCC,cAPqC;;AAAA,mBAQ5BlB,QAAQ,CAAE,KAAF,CARoB;AAAA;AAAA,MAQlDmB,MARkD;AAAA,MAQ1CC,SAR0C;;AAS1D,MAAMC,gBAAgB,GAAGlB,WAAW,CAAEiB,SAAF,EAAahB,aAAb,CAApC;;AAEA,MAAMkB,eAAe,GAAG,SAAlBA,eAAkB,CAAEd,KAAF,EAAa;AACpC;AACAH,IAAAA,WAAW,CAAEC,QAAF,EAAY,aAAZ,EAA2BE,KAA3B,CAAX,CAFoC,CAIpC;AACA;AACA;AACA;;AACAe,IAAAA,QAAQ,CAACC,gBAAT,CAA2B,SAA3B,EAAsCC,iBAAtC;AACAP,IAAAA,cAAc,CAAE,IAAF,CAAd;AACA,GAVD;;AAYA,MAAMQ,aAAa,GAAG,SAAhBA,aAAgB,CAAElB,KAAF,EAAa;AAClCH,IAAAA,WAAW,CAAEC,QAAF,EAAY,WAAZ,EAAyBE,KAAzB,CAAX;AACAe,IAAAA,QAAQ,CAACI,mBAAT,CAA8B,SAA9B,EAAyCF,iBAAzC;AACAP,IAAAA,cAAc,CAAE,KAAF,CAAd;AACA,GAJD;;AAMA,MAAMU,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAEC,IAAF,EAAY;AACpC,QAAKA,IAAI,KAAK,SAAd,EAA0B,OAAOH,aAAP;AAC1B,QAAKG,IAAI,KAAK,WAAd,EAA4B,OAAOP,eAAP;AAC5B,GAHD;AAKA;AACD;AACA;AACA;AACA;AACA;;;AACC,MAAMG,iBAAiB,GAAGG,gBAAgB,CAAE,SAAF,CAA1C;;AAEA,MAAME,kBAAkB,GAAG,SAArBA,kBAAqB,CAAEvB,SAAF,EAAawB,SAAb,EAA4B;AACtD,WAAO,UAAEvB,KAAF,EAAa;AACnB;AACAH,MAAAA,WAAW,CAAEC,QAAF,EAAYC,SAAZ,EAAuBC,KAAvB,CAAX,CAFmB,CAInB;AACA;AACA;AACA;AACA;AACA;;AACA,UAAKA,KAAK,CAACwB,aAAN,CAAoBC,QAAzB,EAAoC;AACnC;AACA,OAZkB,CAcnB;AACA;AACA;;;AACA,UAAK,YAAYzB,KAAK,CAACqB,IAAlB,IAA0BZ,WAA/B,EAA6C;AAC5C;AACA,OAnBkB,CAqBnB;AACA;;;AACAI,MAAAA,gBAAgB,CAACa,MAAjB;;AAEA,UAAMC,OAAO,GAAGxC,QAAQ,CAAE,CAAE,OAAF,EAAW,YAAX,CAAF,EAA6Ba,KAAK,CAACqB,IAAnC,CAAxB;;AACA,UAAKM,OAAO,KAAKhB,MAAjB,EAA0B;AACzB;AACA;;AAED,UAAKY,SAAL,EAAiB;AAChBV,QAAAA,gBAAgB,CAAEc,OAAF,CAAhB;AACA,OAFD,MAEO;AACNf,QAAAA,SAAS,CAAEe,OAAF,CAAT;AACA;AACD,KAnCD;AAoCA,GArCD;;AAsCA,MAAMC,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AAC5Bf,IAAAA,gBAAgB,CAACa,MAAjB;AACA,GAFD;;AAIAnC,EAAAA,SAAS,CAAE;AAAA,WAAMqC,cAAN;AAAA,GAAF,EAAwB,EAAxB,CAAT;;AAEA,MAAKxC,QAAQ,CAACa,KAAT,CAAgBH,QAAhB,MAA+B,CAApC,EAAwC;AACvC,QAAK,kBAAkB+B,OAAO,CAACC,GAAR,CAAYC,QAAnC,EAA8C;AAC7C;AACAC,MAAAA,OAAO,CAACC,KAAR,CACC,4DADD;AAGA;;AAED,WAAOnC,QAAP;AACA;;AAED,MAAMI,KAAK,GAAGd,QAAQ,CAACe,IAAT,CAAeL,QAAf,CAAd;AACA,SAAOT,YAAY,CAAEa,KAAF,EAAS;AAC3BgC,IAAAA,YAAY,EAAEZ,kBAAkB,CAAE,cAAF,EAAkB,IAAlB,CADL;AAE3Ba,IAAAA,YAAY,EAAEb,kBAAkB,CAAE,cAAF,CAFL;AAG3Bc,IAAAA,OAAO,EAAEd,kBAAkB,CAAE,SAAF,CAHA;AAI3Be,IAAAA,OAAO,EAAEf,kBAAkB,CAAE,SAAF,CAJA;AAK3BgB,IAAAA,MAAM,EAAEhB,kBAAkB,CAAE,QAAF,CALC;AAM3BiB,IAAAA,WAAW,EAAEnB,gBAAgB,CAAE,WAAF,CANF;AAO3BtB,IAAAA,QAAQ,EAAER,cAAc,CACvBY,KAAK,CAACE,KAAN,CAAYN,QADW,EAEvBa,MAAM,IACL,cAAC,OAAD;AACC,MAAA,YAAY,EAAG,KADhB;AAEC,MAAA,QAAQ,EAAGL,QAFZ;AAGC,MAAA,SAAS,EAAC,oBAHX;AAIC,qBAAY,MAJb;AAKC,MAAA,OAAO,EAAG,KALX;AAMC,MAAA,OAAO,EAAG;AANX,OAQGC,IARH,EASC,cAAC,QAAD;AACC,MAAA,SAAS,EAAC,8BADX;AAEC,MAAA,QAAQ,EAAGC;AAFZ,MATD,CAHsB;AAPG,GAAT,CAAnB;AA2BA;;AAED,eAAeH,OAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { includes } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tChildren,\n\tcloneElement,\n\tconcatChildren,\n\tuseEffect,\n\tuseState,\n} from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport Popover from '../popover';\nimport Shortcut from '../shortcut';\nimport { useDebounce } from '@wordpress/compose';\n\n/**\n * Time over children to wait before showing tooltip\n *\n * @type {number}\n */\nexport const TOOLTIP_DELAY = 700;\n\nconst emitToChild = ( children, eventName, event ) => {\n\tif ( Children.count( children ) !== 1 ) {\n\t\treturn;\n\t}\n\n\tconst child = Children.only( children );\n\tif ( typeof child.props[ eventName ] === 'function' ) {\n\t\tchild.props[ eventName ]( event );\n\t}\n};\n\nfunction Tooltip( { children, position, text, shortcut } ) {\n\t/**\n\t * Whether a mouse is currently pressed, used in determining whether\n\t * to handle a focus event as displaying the tooltip immediately.\n\t *\n\t * @type {boolean}\n\t */\n\tconst [ isMouseDown, setIsMouseDown ] = useState( false );\n\tconst [ isOver, setIsOver ] = useState( false );\n\tconst delayedSetIsOver = useDebounce( setIsOver, TOOLTIP_DELAY );\n\n\tconst createMouseDown = ( event ) => {\n\t\t// Preserve original child callback behavior\n\t\temitToChild( children, 'onMouseDown', event );\n\n\t\t// On mouse down, the next `mouseup` should revert the value of the\n\t\t// instance property and remove its own event handler. The bind is\n\t\t// made on the document since the `mouseup` might not occur within\n\t\t// the bounds of the element.\n\t\tdocument.addEventListener( 'mouseup', cancelIsMouseDown );\n\t\tsetIsMouseDown( true );\n\t};\n\n\tconst createMouseUp = ( event ) => {\n\t\temitToChild( children, 'onMouseUp', event );\n\t\tdocument.removeEventListener( 'mouseup', cancelIsMouseDown );\n\t\tsetIsMouseDown( false );\n\t};\n\n\tconst createMouseEvent = ( type ) => {\n\t\tif ( type === 'mouseUp' ) return createMouseUp;\n\t\tif ( type === 'mouseDown' ) return createMouseDown;\n\t};\n\n\t/**\n\t * Prebound `isInMouseDown` handler, created as a constant reference to\n\t * assure ability to remove in component unmount.\n\t *\n\t * @type {Function}\n\t */\n\tconst cancelIsMouseDown = createMouseEvent( 'mouseUp' );\n\n\tconst createToggleIsOver = ( eventName, isDelayed ) => {\n\t\treturn ( event ) => {\n\t\t\t// Preserve original child callback behavior\n\t\t\temitToChild( children, eventName, event );\n\n\t\t\t// Mouse events behave unreliably in React for disabled elements,\n\t\t\t// firing on mouseenter but not mouseleave.  Further, the default\n\t\t\t// behavior for disabled elements in some browsers is to ignore\n\t\t\t// mouse events. Don't bother trying to to handle them.\n\t\t\t//\n\t\t\t// See: https://github.com/facebook/react/issues/4251\n\t\t\tif ( event.currentTarget.disabled ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// A focus event will occur as a result of a mouse click, but it\n\t\t\t// should be disambiguated between interacting with the button and\n\t\t\t// using an explicit focus shift as a cue to display the tooltip.\n\t\t\tif ( 'focus' === event.type && isMouseDown ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Needed in case unsetting is over while delayed set pending, i.e.\n\t\t\t// quickly blur/mouseleave before delayedSetIsOver is called\n\t\t\tdelayedSetIsOver.cancel();\n\n\t\t\tconst _isOver = includes( [ 'focus', 'mouseenter' ], event.type );\n\t\t\tif ( _isOver === isOver ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( isDelayed ) {\n\t\t\t\tdelayedSetIsOver( _isOver );\n\t\t\t} else {\n\t\t\t\tsetIsOver( _isOver );\n\t\t\t}\n\t\t};\n\t};\n\tconst clearOnUnmount = () => {\n\t\tdelayedSetIsOver.cancel();\n\t};\n\n\tuseEffect( () => clearOnUnmount, [] );\n\n\tif ( Children.count( children ) !== 1 ) {\n\t\tif ( 'development' === process.env.NODE_ENV ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error(\n\t\t\t\t'Tooltip should be called with only a single child element.'\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tconst child = Children.only( children );\n\treturn cloneElement( child, {\n\t\tonMouseEnter: createToggleIsOver( 'onMouseEnter', true ),\n\t\tonMouseLeave: createToggleIsOver( 'onMouseLeave' ),\n\t\tonClick: createToggleIsOver( 'onClick' ),\n\t\tonFocus: createToggleIsOver( 'onFocus' ),\n\t\tonBlur: createToggleIsOver( 'onBlur' ),\n\t\tonMouseDown: createMouseEvent( 'mouseDown' ),\n\t\tchildren: concatChildren(\n\t\t\tchild.props.children,\n\t\t\tisOver && (\n\t\t\t\t<Popover\n\t\t\t\t\tfocusOnMount={ false }\n\t\t\t\t\tposition={ position }\n\t\t\t\t\tclassName=\"components-tooltip\"\n\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\tanimate={ false }\n\t\t\t\t\tnoArrow={ true }\n\t\t\t\t>\n\t\t\t\t\t{ text }\n\t\t\t\t\t<Shortcut\n\t\t\t\t\t\tclassName=\"components-tooltip__shortcut\"\n\t\t\t\t\t\tshortcut={ shortcut }\n\t\t\t\t\t/>\n\t\t\t\t</Popover>\n\t\t\t)\n\t\t),\n\t} );\n}\n\nexport default Tooltip;\n"]}